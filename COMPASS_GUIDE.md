# 实时罗盘对准功能使用说明

## 功能概述

实时罗盘对准功能使用您的设备（手机或平板）内置的方向传感器（陀螺仪/罗盘），帮助您在现场快速准确地调整天线方向。

## 工作原理

1. **计算目标方位角**：首先输入地面站位置并计算参数，系统会计算出天线需要指向的方位角
2. **启动罗盘**：点击"启动罗盘"按钮，授权设备传感器访问权限
3. **实时对准指示**：
   - 红色箭头：表示设备当前朝向与目标方位不一致
   - 绿色箭头：表示设备已对准目标方位（误差在 ±5° 以内）
4. **调整天线**：手持设备，旋转设备直到箭头变为绿色，此时设备朝向即为天线应该指向的方向

## 使用步骤

### 1. 计算方位角
```
1. 选择目标卫星
2. 输入地面站的经纬度（或点击"获取位置"）
3. 点击"计算参数"
4. 记录计算出的方位角
```

### 2. 启动罗盘对准
```
1. 在结果下方会出现"实时方位对准"模块
2. 点击"启动罗盘"按钮
3. iOS 设备可能需要授权访问动作与方向权限
4. 授权后，罗盘界面会显示当前设备朝向
```

### 3. 现场对准天线
```
1. 手持设备（保持设备顶部朝向前方）
2. 缓慢旋转身体和设备
3. 观察屏幕上的箭头颜色：
   - 红色箭头：继续调整方向
   - 绿色箭头：已对准，此时设备朝向即为天线方向
4. 记住对准时的参照物（如建筑物、山峰等）
5. 调整天线指向该方向
```

## 界面说明

### 罗盘显示区域
- **方向标记**：N (北)、E (东)、S (南)、W (西)
- **橙色目标线**：目标方位角的位置
- **箭头**：代表设备当前朝向
  - 红色：未对准
  - 绿色：已对准（闪烁动画）

### 信息面板
- **当前朝向**：设备当前指向的方位角
- **目标方位**：计算出的目标方位角
- **偏差**：当前朝向与目标的角度差
- **已对准！**：当偏差 ≤ 5° 时显示

## 兼容性

### 支持的设备
- ✅ iOS 设备（iPhone、iPad）- 需要 iOS 13+
- ✅ Android 设备 - 需要内置陀螺仪/磁力计
- ❌ 桌面电脑（无方向传感器）

### 浏览器要求
- iOS：Safari、Chrome
- Android：Chrome、Firefox、Edge
- 需要 HTTPS 连接（本地开发时除外）

## 权限说明

### iOS 设备
iOS 13+ 需要用户明确授权才能访问设备方向数据：
1. 点击"启动罗盘"
2. 系统会弹出授权请求
3. 选择"允许"
4. 罗盘开始工作

### Android 设备
大多数 Android 设备无需额外授权，直接使用。

## 注意事项

1. **设备校准**
   - 某些设备可能需要先校准罗盘
   - 在使用前可以打开设备的指南针应用进行校准
   - 远离磁性物体（如金属、扬声器等）

2. **精度限制**
   - 设备传感器精度通常在 ±5-10° 范围
   - 建议配合专业仪器进行最终精确调整
   - 环境磁场可能影响精度

3. **使用环境**
   - 在空旷地带使用效果最佳
   - 避免在强磁场或金属结构附近使用
   - 保持设备水平以获得最佳精度

4. **最佳实践**
   - 先使用罗盘找到大致方向
   - 记录对准时的参照物
   - 使用信号强度仪进行精确调整

## 故障排除

### "您的设备不支持方向传感器"
- 设备没有内置陀螺仪或磁力计
- 建议使用传统罗盘或指南针

### "需要授权访问设备方向传感器"
- iOS 用户拒绝了权限请求
- 解决方法：
  1. 进入设置 > Safari > 隐私与安全性
  2. 找到该网站
  3. 允许动作与方向访问

### 箭头不转动
- 检查设备传感器是否工作
- 尝试重启罗盘
- 校准设备指南针

### 读数不准确
- 检查周围是否有磁性干扰
- 重新校准设备指南针
- 确保设备保持水平

## 技术实现

使用 Web 标准 API：
- `DeviceOrientationEvent`：获取设备方向
- `webkitCompassHeading`（iOS）：精确的罗盘方向
- `alpha`（Android）：设备旋转角度

## 多语言支持

界面支持中英文切换：
- 中文：实时方位对准、启动罗盘、当前朝向等
- English: Real-time Direction Alignment, Start Compass, Current Heading, etc.
